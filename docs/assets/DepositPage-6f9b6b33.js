import{a as p,H as h}from"./helpers-e3b30bc1.js";import{N as X,B as Y,g as N,O as $,e as se,f as G,h as ae,R as L,a as m,b as e,G as oe,u as t,c as S,w as A,i as U,F as T,j as ne,o as i,l as k,m as Q,t as d,v as E,p as O}from"./index-3efd29d9.js";import{_ as le,a as re,b as ie}from"./EmptyResourceComponent-c4bb86e1.js";import{_ as ce}from"./MyDropdownComponent-1207980f.js";import{u as Z}from"./user.store-588551b2.js";const ue=X("otherDeposit",()=>{const u=Y(),b=Z(),c="/other-deposit",f=N([]),v=N(!1);function C(s){f.value=s}function y(s){v.value=s}function P(s,n){const l=f.value;if(!l)return;const D=l.findIndex(g=>g._id===s);l[D]=n,C(l)}async function w(){y(!1);try{const s=await $.get(`/master${c}`);C(s.data.data.otherDeposits)}catch(s){console.error(s),u.handlePost(s.response)}y(!0)}async function _(s,n){try{u.setPost(!0);const l=await $.patch(`/master${c}/update-status/${s}`,{status:n});P(s,l.data.data.otherDeposit),b.fetchAll(),u.handlePost(l)}catch(l){console.error(l),u.handlePost(l.response)}}async function H(s){try{u.setPost(!0);const n=await $.delete(`/master${c}/delete/${s}`),l=f.value;if(!l)return;const D=l.filter(g=>g._id!==s);C(D),u.handlePost(n)}catch(n){console.error(n),u.handlePost(n.response)}}return{loaded:v,otherDeposits:f,fetchAll:w,updateStatus:_,deleteOne:H}}),de=X("deposit",()=>{const u=Y(),b=Z(),c="/deposit",f=N([]),v=N(!1);function C(s){f.value=s}function y(s){v.value=s}function P(s,n){const l=f.value;if(!l)return;const D=l.findIndex(g=>g._id===s);l[D]=n,C(l)}async function w(){y(!1);try{const s=await $.get(`/master${c}`);C(s.data.data.deposits)}catch(s){console.error(s),u.handlePost(s.response)}y(!0)}async function _(s,n){try{u.setPost(!0);const l=await $.patch(`/master${c}/update-status/${s}`,{status:n});P(s,l.data.data.deposit),b.fetchAll(),u.handlePost(l)}catch(l){console.error(l),u.handlePost(l.response)}}async function H(s){try{u.setPost(!0);const n=await $.delete(`/master${c}/delete/${s}`),l=f.value;if(!l)return;const D=l.filter(g=>g._id!==s);C(D),u.handlePost(n)}catch(n){console.error(n),u.handlePost(n.response)}}return{loaded:v,deposits:f,fetchAll:w,updateStatus:_,deleteOne:H}}),pe={class:"row mt-4"},he={class:"col-12"},me={class:"custom-tab-1"},fe={class:"tab-content"},ve={id:"crypto",class:"tab-pane fade active show"},ye={class:"card"},be={key:1,class:"card-body pt-0 px-0"},De={class:"d-none"},Ce=["onClick"],_e=["onClick"],ge=["onClick"],ke={class:"text-center"},we={class:"d-flex"},Ne=["src","alt"],Pe={class:"d-flex flex-column"},He={class:"fw-bold"},Se={class:"fs-14"},Ae={id:"others",class:"tab-pane fade"},Ee={class:"card"},Oe={key:1,class:"card-body pt-0 px-0"},$e={class:"d-none"},xe=["onClick"],Ie=["onClick"],Ge=["onClick"],Le={class:"text-center"},Be=se({__name:"DepositPage",setup(u){const b=N(!1),c=N(),f=a=>c.value=a,v=N(),C=a=>v.value=a,y=de(),P=G(()=>y.deposits),w=G(()=>y.loaded);w.value||y.fetchAll();const _=ue(),H=G(()=>_.otherDeposits),s=G(()=>_.loaded);s.value||_.fetchAll();const n=ae({status:L.INFO,title:"",message:"",onConfirm:()=>{}}),l=(a,r)=>{var x;f(a),C(r),r===p.APPROVED?(n.status=L.INFO,n.title="Do you really wants to approve this deposit?",n.message=`Approving this deposit will credit ${h.toTitleCase(((x=a.user)==null?void 0:x.username)||"Unknown")} with the sum of ${h.toCurrency(a.amount)} and cannot be reversed.`):(n.status=L.WARNING,n.title="Do you really wants to cancel this deposit?",n.message=`Canceling this deposit mark it has ${r} whereby the user will not be credited`),n.onConfirm=g,b.value=!0},D=a=>{c.value=a,n.status=L.DANGER,n.title="Do you really wants to delete this deposit?",n.message="Deleting this deposit can not be reversed",n.onConfirm=ee,b.value=!0},g=()=>{c.value&&(v.value!==p.APPROVED&&v.value!==p.CANCELLED||(b.value=!1,c.value.type?_.updateStatus(c.value._id,v.value):y.updateStatus(c.value._id,v.value)))},ee=()=>{c.value&&(b.value=!1,c.value.type?_.deleteOne(c.value._id):y.deleteOne(c.value._id))};return(a,r)=>{var F,M;const x=le,V=ie,j=ce,B=re,te=ne;return i(),m(T,null,[e("div",pe,[e("div",he,[e("div",me,[r[13]||(r[13]=oe('<ul class="nav nav-tabs border-2 d-flex text-nowrap mb-4"><li class="nav-item"><a href="#crypto" data-bs-toggle="tab" class="nav-link show active rounded-top m-0 text-center" style="border:none;">Crypto</a></li><li class="nav-item"><a href="#others" data-bs-toggle="tab" class="nav-link rounded-top m-0 text-center" style="border:none;">Others</a></li></ul>',1)),e("div",fe,[e("div",ve,[e("div",ye,[r[6]||(r[6]=e("div",{class:"card-header"},[e("h4",{class:"card-title"},"Users Deposits")],-1)),t(w)&&!((F=t(P))!=null&&F.length)?(i(),S(x,{key:0},{default:A(()=>r[1]||(r[1]=[k(" No Deposit Record Found ")])),_:1})):(i(),m("div",be,[t(w)?(i(),S(B,{key:1,ordering:"",searching:""},{default:A(()=>[r[5]||(r[5]=e("thead",{class:"bg-background"},[e("tr",null,[e("th",{class:"text-sharp d-none"},"Sort"),e("th",{class:"text-sharp text-center"},"Action"),e("th",{class:"text-sharp text-center"},"Status"),e("th",{class:"text-sharp"},"User"),e("th",{class:"text-sharp"},"Amount"),e("th",{class:"text-sharp"},"Currency"),e("th",{class:"text-sharp"},"Network"),e("th",{class:"text-sharp"},"Created"),e("th",{class:"text-sharp"},"Settled")])],-1)),e("tbody",null,[(i(!0),m(T,null,Q(t(P),(o,R)=>{var I,z,W,q,J,K;return i(),m("tr",{key:o._id},[e("td",De,d(R+1),1),e("td",null,[U(j,null,{default:A(()=>[o.status===t(p).PENDING?(i(),m("a",{key:0,onClick:()=>l(o,t(p).APPROVED),class:"dropdown-item border-bottom",href:"javascript:;"},r[2]||(r[2]=[e("i",{class:E("bi bi-check-circle me-2")},null,-1),k("Approve")]),8,Ce)):O("",!0),o.status===t(p).PENDING?(i(),m("a",{key:1,onClick:()=>l(o,t(p).CANCELLED),class:"dropdown-item",href:"javascript:;"},r[3]||(r[3]=[e("i",{class:E("bi bi-slash-circle me-2")},null,-1),k("Cancel")]),8,_e)):O("",!0),o.status!==t(p).PENDING?(i(),m("a",{key:2,onClick:()=>D(o),class:"dropdown-item",href:"javascript:;"},r[4]||(r[4]=[e("i",{class:"bi bi-trash me-2"},null,-1),k("Delete")]),8,ge)):O("",!0)]),_:2},1024)]),e("td",ke,[e("span",{class:E(`badge light badge-${("Helpers"in a?a.Helpers:t(h)).toStatus(o.status)}`)},d(("Helpers"in a?a.Helpers:t(h)).toTitleCase(o.status)),3)]),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toTitleCase(((I=o.user)==null?void 0:I.username)||"Unknown")),1),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toCurrency(o.amount)),1),e("td",null,[e("div",we,[e("img",{src:`/icons/crypto-svg/${(z=o.currency)==null?void 0:z.logo}`,class:"me-3",alt:(W=o.currency)==null?void 0:W.name,width:"24"},null,8,Ne),e("div",Pe,[e("span",He,d(("Helpers"in a?a.Helpers:t(h)).toTitleCase(((q=o.currency)==null?void 0:q.name)||"Unknown")),1),e("span",Se,d((J=o.currency)==null?void 0:J.symbol.toUpperCase()),1)])])]),e("td",null,d((K=o.depositMethod)==null?void 0:K.network.toUpperCase()),1),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toNiceDate(o.createdAt)),1),e("td",null,d(o.status===t(p).PENDING?"--":("Helpers"in a?a.Helpers:t(h)).toNiceDate(o.updatedAt)),1)])}),128))])]),_:1})):(i(),S(V,{key:0,rows:8,cols:6,searching:""}))]))])]),e("div",Ae,[e("div",Ee,[r[12]||(r[12]=e("div",{class:"card-header"},[e("h4",{class:"card-title"},"Users Deposits")],-1)),t(s)&&!((M=t(H))!=null&&M.length)?(i(),S(x,{key:0},{default:A(()=>r[7]||(r[7]=[k(" No Deposit Record Found ")])),_:1})):(i(),m("div",Oe,[t(s)?(i(),S(B,{key:1,ordering:"",searching:""},{default:A(()=>[r[11]||(r[11]=e("thead",{class:"bg-background"},[e("tr",null,[e("th",{class:"text-sharp d-none"},"Sort"),e("th",{class:"text-sharp text-center"},"Action"),e("th",{class:"text-sharp text-center"},"Status"),e("th",{class:"text-sharp"},"User"),e("th",{class:"text-sharp"},"Amount"),e("th",{class:"text-sharp"},"Type"),e("th",{class:"text-sharp"},"Created"),e("th",{class:"text-sharp"},"Settled")])],-1)),e("tbody",null,[(i(!0),m(T,null,Q(t(H),(o,R)=>{var I;return i(),m("tr",{key:o._id},[e("td",$e,d(R+1),1),e("td",null,[U(j,null,{default:A(()=>[o.status===t(p).PENDING?(i(),m("a",{key:0,onClick:()=>l(o,t(p).APPROVED),class:"dropdown-item border-bottom",href:"javascript:;"},r[8]||(r[8]=[e("i",{class:E("bi bi-check-circle me-2")},null,-1),k("Approve")]),8,xe)):O("",!0),o.status===t(p).PENDING?(i(),m("a",{key:1,onClick:()=>l(o,t(p).CANCELLED),class:"dropdown-item",href:"javascript:;"},r[9]||(r[9]=[e("i",{class:E("bi bi-slash-circle me-2")},null,-1),k("Cancel")]),8,Ie)):O("",!0),o.status!==t(p).PENDING?(i(),m("a",{key:2,onClick:()=>D(o),class:"dropdown-item",href:"javascript:;"},r[10]||(r[10]=[e("i",{class:"bi bi-trash me-2"},null,-1),k("Delete")]),8,Ge)):O("",!0)]),_:2},1024)]),e("td",Le,[e("span",{class:E(`badge light badge-${("Helpers"in a?a.Helpers:t(h)).toStatus(o.status)}`)},d(("Helpers"in a?a.Helpers:t(h)).toTitleCase(o.status)),3)]),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toTitleCase(((I=o.user)==null?void 0:I.username)||"Unknown")),1),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toCurrency(o.amount)),1),e("td",null,d(o.type),1),e("td",null,d(("Helpers"in a?a.Helpers:t(h)).toNiceDate(o.createdAt)),1),e("td",null,d(o.status===t(p).PENDING?"--":("Helpers"in a?a.Helpers:t(h)).toNiceDate(o.updatedAt)),1)])}),128))])]),_:1})):(i(),S(V,{key:0,rows:8,cols:6,searching:""}))]))])])])])])]),U(te,{"is-open":t(b),status:t(n).status,title:t(n).title,message:t(n).message,onConfirm:t(n).onConfirm,onClose:r[0]||(r[0]=o=>b.value=!1)},null,8,["is-open","status","title","message","onConfirm"])],64)}}});export{Be as default};
