import{e as G,o as P,a as N,b as e,u as o,D as O,t as p,l as k,d as W,N as X,B as Y,g as h,O as w,f as E,h as Z,R as z,F as L,m as ee,i as _,w as M,j as te,k as se,c as V,p as ne,n as ae,y as oe}from"./index-3efd29d9.js";import{_ as le}from"./MyImageFileComponent-63685e36.js";import{H as re}from"./helpers-e3b30bc1.js";import{c as ie,b as de,a as F}from"./index.esm-3fd077bb.js";const ce={class:"col-xl-4 col-lg-6 col-sm-12"},ue={class:"card"},me={class:"card-header border-0 pb-0 flex-column justify-content-center align-items-center gap-2"},ge={class:"media me-2 rounded-profile overflow-hidden"},pe=["src"],fe={class:"d-flex flex-column justify-content-between"},he={class:"card-title fw-bold"},_e={class:"card-body pt-0"},ve={class:"text-white mb-2"},Se={class:"ms-3 fw-bold text-primary fs-5"},be={class:"text-white mb-2"},ye={class:"ms-3 fw-bold text-warning fs-5"},we={class:"text-white mb-2"},Pe={class:"ms-3 fw-bold text-success fs-5"},Ce=G({__name:"SignalCardComponent",props:{signal:{}},setup(d){return(r,i)=>(P(),N("div",ce,[e("div",ue,[e("div",me,[e("div",ge,[e("img",{alt:"image",width:"50",src:`${("config"in r?r.config:o(O)).imageHost}/icon/original/${r.signal.icon}`},null,8,pe)]),e("div",fe,[e("h2",he,p(r.signal.name),1)])]),i[3]||(i[3]=e("hr",{class:"mt-2"},null,-1)),e("div",_e,[e("ul",null,[e("li",ve,[i[0]||(i[0]=k(" Amount: ")),e("span",Se,p(("Helpers"in r?r.Helpers:o(re)).toCurrency(r.signal.amount)),1)]),e("li",be,[i[1]||(i[1]=k(" Signal Strength: ")),e("span",ye,"+ "+p(r.signal.signalStrength)+" %",1)]),e("li",we,[i[2]||(i[2]=k(" Increase Profit By: ")),e("span",Pe,p(r.signal.dailyPercentageProfit)+" % ",1)])]),W(r.$slots,"default")])])]))}});const $e=X("signal",()=>{const d=Y(),r="signal",i=h([]),C=h(!1);function u(s){i.value=s}function $(s){C.value=s}function I(s,n){const a=i.value;if(!a)return;const S=a.findIndex(b=>b._id===s);a[S]=n,u(a)}async function m(s){try{d.setPost(!0);const n=await w.patch(`master/${r}/update-status/${s.signalId}`,s);I(s.signalId,n.data.data.signal),d.handlePost(n)}catch(n){console.error(n),d.handlePost(n.response)}}async function A(){$(!1);try{const s=await w.get(`master/${r}`);u(s.data.data.signals)}catch(s){console.error(s),d.handlePost(s.response)}$(!0)}async function g(s){try{d.setPost(!0);const n=await w.post(`master/${r}/create`,s),{signal:a}=n.data.data;return u([...i.value,a]),d.handlePost(n),!0}catch(n){return console.error(n),d.handlePost(n.response),!1}}async function x(s,n){try{d.setPost(!0);const a=await w.put(`master/${r}/update/${s}`,n);return I(s,a.data.data.signal),d.handlePost(a),!0}catch(a){return console.error(a),d.handlePost(a.response),!1}}async function v(s){try{d.setPost(!0);const n=await w.delete(`master/${r}/delete/${s}`),a=i.value;if(!a)return;const S=a.filter(b=>b._id!==s);return u(S),d.handlePost(n),!0}catch(n){return console.error(n),d.handlePost(n.response),!1}}return{loaded:C,signals:i,fetchAll:A,createSignal:g,updateSignalStatus:m,deleteSignal:v,updateSignal:x}}),xe={class:"d-flex justify-content-end mb-3 border-bottom pb-3"},Ie={class:"row"},Ae={class:"dropdown-menu"},ke=["onClick"],Me=["onClick"],Fe={class:"w-100"},Ne={class:"mb-3 offset-md-3 col-md-6"},qe={class:"error-message file-error"},je={class:"mb-3"},Be={class:"error-message"},He={class:"mb-3"},De={class:"error-message"},Ee={class:"mb-3"},ze={class:"error-message"},Le={class:"mb-3"},Ve={class:"error-message"},Te=G({__name:"SignalPage",setup(d){const r=h(),i=h(),C=(l,t)=>{r.value=l,i.value=t==null?void 0:t.src},u=$e(),$=E(()=>u.signals);E(()=>u.loaded).value||u.fetchAll();const m=h();h();const A=l=>m.value=l,g=h(),x=h(!1),v=(l,t,c)=>{i.value=`${O.value.imageHost}/icon/original/${c==null?void 0:c.icon}`,x.value=l,g.value=t,m.value=c},s=h(!1),n=l=>s.value=l,a=Z({status:z.INFO,title:"",message:"",onConfirm:()=>{}}),S=l=>{a.status=l.status,a.title=l.title,a.message=l.message,a.onConfirm=l.onConfirm},b=ie({name:de().required("Signal name is required"),amount:F().typeError("Amount is required").positive("Amount should be greater than zero").required("Amount is required"),signalStrength:F().typeError("Signal Strength is required").positive("Signal Strength should be greater than zero").required("Signal Strength is required"),dailyPercentageProfit:F().typeError("Profit Increase is required").positive("Profit Increase should be greater than zero").required("Profit Increase is required")}),R=l=>{A(l),S({status:z.DANGER,title:"Do you really wants to delete this signal",message:"Please note that this action cannot be reversed",onConfirm:async()=>{m.value&&(await u.deleteSignal(m.value._id),n(!1))}}),n(!0)},J=async l=>{let t=!1;const c=new FormData;c.append("icon",r.value),c.append("name",l.name),c.append("amount",l.amount),c.append("signalStrength",l.signalStrength),c.append("dailyPercentageProfit",l.dailyPercentageProfit),g.value===0?t=await u.createSignal(c):t=await u.updateSignal(l.signalId,c),t&&(v(!1),r.value=null)};return(l,t)=>{const c=Ce,T=te,y=oe,U=le,K=se;return P(),N(L,null,[e("div",xe,[e("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=()=>v(!0,0))}," Add New ")]),e("div",Ie,[(P(!0),N(L,null,ee(o($),f=>(P(),V(c,{signal:f,key:f._id},{default:M(()=>[t[3]||(t[3]=e("button",{type:"button",class:"btn btn-outline-secondary w-100 mt-3 dropdown-toggle","data-bs-toggle":"dropdown"}," Action ",-1)),e("div",Ae,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>v(!0,1,f)},"Edit",8,ke),e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>R(f)},"Delete",8,Me)])]),_:2},1032,["signal"]))),128))]),_(T,{"is-open":o(s),status:o(a).status,title:o(a).title,message:o(a).message,onConfirm:o(a).onConfirm,onClose:t[1]||(t[1]=()=>n(!1))},null,8,["is-open","status","title","message","onConfirm"]),_(K,{"is-open":o(x),onClose:t[2]||(t[2]=()=>v(!1)),onConfirm:J,"validation-schema":o(b),title:o(g)===0?"Create New Signal":"Update Signal"},{default:M(({errors:f})=>{var q,j,B,H,D;return[e("div",Fe,[o(g)===1?(P(),V(y,{key:0,name:"signalId",type:"hidden",class:"form-control",value:(q=o(m))==null?void 0:q._id},null,8,["value"])):ne("",!0),e("div",Ne,[t[5]||(t[5]=e("label",{class:"form-label text-sharp"},"Signal Image",-1)),e("div",null,[_(U,{name:"documentImage",type:["image/jpg","image/jpeg","image/png","image/gif"],size:11e6,onChange:C,class:"w-100"},{default:M(({errors:Q})=>[e("div",{class:"px-4 d-flex justify-content-center align-items-center flex-column upload-area",style:ae({backgroundImage:`url(${o(i)})`,backgroundPosition:"center",backgroundSize:"cover",aspectRatio:"1/1",height:"200px"})},t[4]||(t[4]=[e("span",{class:"drop-zoon__icon"},[e("svg",{class:"upload-icon",width:"40",height:"40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M13.438 12.81L20 6.25l6.563 6.56M20 23.75V6.255M33.75 23.75v8.75a1.25 1.25 0 01-1.25 1.25h-25a1.25 1.25 0 01-1.25-1.25v-8.75",stroke:"#366CE3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),e("p",{class:"desc body-sb"},p("Max 11MB, PNG, JPEG, JPG"),-1)]),4),e("span",qe,p(Q[0]),1)]),_:2},1024)])]),e("div",je,[t[6]||(t[6]=e("label",{class:"form-label text-sharp"},"Signal Name",-1)),_(y,{name:"name",type:"text",placeholder:"Signal Name",class:"form-control","validate-on-input":!0,value:o(g)===0?"":(j=o(m))==null?void 0:j.name},null,8,["value"]),e("span",Be,p(f.name),1)]),e("div",He,[t[7]||(t[7]=e("label",{class:"form-label text-sharp"},"Amount",-1)),_(y,{name:"amount",type:"number",placeholder:"Amount",class:"form-control","validate-on-input":!0,value:o(g)===0?"":(B=o(m))==null?void 0:B.amount},null,8,["value"]),e("span",De,p(f.amount),1)]),e("div",Ee,[t[8]||(t[8]=e("label",{class:"form-label text-sharp"},"Signal Strength to Add",-1)),_(y,{name:"signalStrength",type:"number",placeholder:"Signal Strength to Add",class:"form-control","validate-on-input":!0,value:o(g)===0?"":(H=o(m))==null?void 0:H.signalStrength},null,8,["value"]),e("span",ze,p(f.signalStrength),1)]),e("div",Le,[t[9]||(t[9]=e("label",{class:"form-label text-sharp"},"Increase Profit By (%)",-1)),_(y,{name:"dailyPercentageProfit",type:"number",placeholder:"Increase Profit By (%)",class:"form-control","validate-on-input":!0,value:o(g)===0?"":(D=o(m))==null?void 0:D.dailyPercentageProfit},null,8,["value"]),e("span",Ve,p(f.dailyPercentageProfit),1)])])]}),_:1},8,["is-open","validation-schema","title"])],64)}}});export{Te as default};
