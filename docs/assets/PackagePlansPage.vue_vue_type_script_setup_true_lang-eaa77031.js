import{e as re,o as m,a as h,b as e,t as u,l as k,F as q,m as I,u as n,d as ve,N as ie,B as de,g as v,O as D,f as N,h as he,R as ne,i as g,w as V,j as _e,k as be,c as oe,p as R,v as ae,P as ge,y as ye}from"./index-3efd29d9.js";import{H as j}from"./helpers-e3b30bc1.js";import{c as Pe,b as T,a as E,d as le}from"./index.esm-3fd077bb.js";const we={class:"col-xl-4 col-lg-6 col-sm-12"},Ae={class:"card"},Ce={class:"card-header border-0 pb-0 justify-content-start align-items-stretch gap-2"},$e={class:"d-flex flex-column justify-content-between"},xe={class:"card-title fw-bold"},ke={class:"d-flex gap-2 align-items-center"},Me={class:"mb-0"},De={class:"card-body pb-0"},Se={class:"card-body pt-0"},qe={class:"text-white mb-2 d-flex gap-2 align-items-center"},He={class:"ms-3 fs-5 avatar-group1"},Fe=["src","alt"],Ne={class:"text-white mb-2"},je={class:"ms-3 fw-bold text-cyan2 fs-5"},Ee={class:"text-white mb-2"},Ie={class:"ms-3 fw-bold text-primary fs-5"},Le={class:"text-white mb-2"},ze={class:"ms-3 fw-bold text-primary fs-5"},Be={class:"text-white mb-2"},Oe={class:"ms-3 fw-bold text-warning fs-5"},Ve={class:"text-white mb-2"},Re={class:"ms-3 fw-bold text-success fs-5"},Te=re({__name:"PackagePlanCardComponent",props:{plan:{}},setup(c){return(s,r)=>(m(),h("div",we,[e("div",Ae,[e("div",Ce,[e("div",$e,[e("h2",xe,u(s.plan.name),1),e("div",ke,[e("p",Me,u(s.plan.engine),1)])])]),e("div",De,[e("p",null,u(s.plan.description),1)]),r[6]||(r[6]=e("hr",{class:"mt-2"},null,-1)),e("div",Se,[e("ul",null,[e("li",qe,[r[0]||(r[0]=k(" Assets: ")),e("div",He,[(m(!0),h(q,null,I(s.plan.assets.slice().reverse(),_=>(m(),h("a",{key:_._id,class:"avatar-group-item1",href:"javascript: void(0);"},[e("img",{src:`/icons/crypto-svg/${_.logo}`,class:"",alt:`${_.name}`,width:"24"},null,8,Fe)]))),128))])]),e("li",Ne,[r[1]||(r[1]=k(" Trading Duration: ")),e("span",je,u(s.plan.duration)+" "+u(s.plan.duration>1?"days":"day"),1)]),e("li",Ee,[r[2]||(r[2]=k(" Amount: ")),e("span",Ie,u(("Helpers"in s?s.Helpers:n(j)).toCurrency(s.plan.minAmount))+" - "+u(("Helpers"in s?s.Helpers:n(j)).toCurrency(s.plan.maxAmount)),1)]),e("li",Le,[r[3]||(r[3]=k(" Profit: ")),e("span",ze,u(("Helpers"in s?s.Helpers:n(j)).toCurrency(s.plan.minAmount*s.plan.potentialPercentageProfit/100))+" - "+u(("Helpers"in s?s.Helpers:n(j)).toCurrency(s.plan.maxAmount*s.plan.potentialPercentageProfit/100)),1)]),e("li",Be,[r[4]||(r[4]=k(" Daily Profit: ")),e("span",Oe,u(s.plan.dailyPercentageProfit)+" %",1)]),e("li",Ve,[r[5]||(r[5]=k(" Profit on Completion: ")),e("span",Re,u(s.plan.potentialPercentageProfit)+" %",1)])]),ve(s.$slots,"default")])])]))}});const Ge=ie("plan",()=>{const c=de(),s="plan",r=v([]),_=v(!1);function b(a){r.value=a}function $(a){_.value=a}function S(a,l){const f=r.value;if(!f)return;const p=f.findIndex(M=>M._id===a);f[p]=l,b(f)}async function i(a){try{c.setPost(!0);const l=await D.patch(`master/${s}/update-status/${a.planId}`,a);S(a.planId,l.data.data.plan),c.handlePost(l)}catch(l){console.error(l),c.handlePost(l.response)}}async function x(){$(!1);try{const a=await D.get(`master/${s}`);b(a.data.data.plans)}catch(a){console.error(a),c.handlePost(a.response)}$(!0)}async function P(a){try{c.setPost(!0);const l=await D.post(`master/${s}/create`,a),{plan:f}=l.data.data;return b([...r.value,f]),c.handlePost(l),!0}catch(l){return console.error(l),c.handlePost(l.response),!1}}async function L(a){try{c.setPost(!0);const l=await D.put(`master/${s}/update/${a.planId}`,a);return S(a.planId,l.data.data.plan),c.handlePost(l),!0}catch(l){return console.error(l),c.handlePost(l.response),!1}}async function z(a){try{c.setPost(!0);const l=await D.delete(`master/${s}/delete/${a}`),f=r.value;if(!f)return;const p=f.filter(M=>M._id!==a);return b(p),c.handlePost(l),!0}catch(l){return console.error(l),c.handlePost(l.response),!1}}return{loaded:_,plans:r,fetchAll:x,createPlan:P,updatePlanStatus:i,deletePlan:z,updatePlan:L}}),Ue=ie("asset",()=>{const c=de(),s="asset",r=v([]),_=v(!1);function b(i){r.value=i}function $(i){_.value=i}async function S(){$(!1);try{const i=await D.get(`master/${s}`);b(i.data.data.assets)}catch(i){console.error(i),c.handlePost(i.response)}$(!0)}return{loaded:_,assets:r,fetchAll:S}}),Je={class:"d-flex justify-content-end mb-3 border-bottom pb-3"},Ke={class:"row"},Qe={class:"dropdown-menu"},We=["onClick"],Xe=["onClick"],Ye={class:"w-100"},Ze={class:"mb-3"},et={class:"error-message"},tt={class:"mb-3"},st={class:"error-message"},nt={class:"mb-3"},ot={class:"error-message"},at={class:"mb-3"},lt={class:"error-message"},rt={class:"mb-3"},it={class:"error-message"},dt={class:"mb-3"},ut={class:"error-message"},ct={class:"mb-3"},pt={class:"error-message"},mt={class:"mb-3"},ft={class:"d-flex justify-content-between align-items-center"},vt={class:"d-flex gap-3 flex-wrap"},ht=["onClick"],_t=["onClick"],bt=["src","alt"],gt={class:""},yt={class:"d-flex gap-3 flex-wrap"},Pt=["onClick"],wt=["onClick"],At=["src","alt"],Ct={class:""},Mt=re({__name:"PackagePlansPage",setup(c){const s=Ge(),r=N(()=>s.plans);N(()=>s.loaded).value||s.fetchAll();const b=Ue(),$=N(()=>b.assets);N(()=>b.loaded).value||b.fetchAll();const i=v();v();const x=v(),P=v([]),L=o=>i.value=o,z=o=>{if(x.value)return x.value=void 0;x.value=o},a=o=>{P.value=o},l=o=>{const t=P.value.slice();t.push(o),a(t)},f=o=>{const t=P.value.filter(y=>y._id!==o._id);a(t)},p=v(),M=v(!1),H=(o,t,y)=>{M.value=o,p.value=t,i.value=y,a(y?y.assets:[])},G=v(!1),B=o=>{G.value=o},U=v(!1),O=o=>U.value=o,w=he({status:ne.INFO,title:"",message:"",onConfirm:()=>{}}),ue=o=>{w.status=o.status,w.title=o.title,w.message=o.message,w.onConfirm=o.onConfirm},ce=Pe({name:T().required("Plane name is required"),engine:T().required("Engine is required"),description:T().required("Description is required"),minAmount:E().typeError("Min amount is required").positive("Min amount should be greater than zero").required("Min amount is required"),maxAmount:E().typeError("Max amount is required").positive("Max amount should be greater than zero").required("Max amount is required").test("is-greater","Max amount should be greater than the min",function(o){return this.resolve(le("minAmount"))?o>this.resolve(le("minAmount")):!0}),dailyPercentageProfit:E().typeError("Daily percentage profit is required").positive("Daily percentage profit should be greater than zero").required("Daily percentage profit is required"),duration:E().typeError("Duration is required").positive("Duration should be greater than zero").required("Duration is required")}),pe=o=>{L(o),ue({status:ne.DANGER,title:"Do you really wants to delete this plan",message:"Please note that this action cannot be reversed",onConfirm:async()=>{i.value&&(await s.deletePlan(i.value._id),O(!1))}}),O(!0)},me=async o=>{o.assets=P.value.map(y=>y._id);let t=!1;p.value===0?t=await s.createPlan(o):t=await s.updatePlan(o),t&&H(!1)};return(o,t)=>{const y=Te,fe=_e,A=ye,J=be;return m(),h(q,null,[e("div",Je,[e("button",{class:"btn btn-primary",type:"button",onClick:t[0]||(t[0]=()=>H(!0,0))}," Add New ")]),e("div",Ke,[(m(!0),h(q,null,I(n(r),d=>(m(),oe(y,{plan:d,key:d._id},{default:V(()=>[t[6]||(t[6]=e("button",{type:"button",class:"btn btn-outline-secondary w-100 mt-3 dropdown-toggle","data-bs-toggle":"dropdown"}," Action ",-1)),e("div",Qe,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>H(!0,1,d)},"Edit",8,We),e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:()=>pe(d)},"Delete",8,Xe)])]),_:2},1032,["plan"]))),128))]),g(fe,{"is-open":n(U),status:n(w).status,title:n(w).title,message:n(w).message,onConfirm:n(w).onConfirm,onClose:t[1]||(t[1]=()=>O(!1))},null,8,["is-open","status","title","message","onConfirm"]),g(J,{"is-open":n(M),onClose:t[3]||(t[3]=()=>H(!1)),onConfirm:me,"validation-schema":n(ce),title:n(p)===0?"Create New Plan":"Update Plan"},{default:V(({errors:d})=>{var F,K,Q,W,X,Y,Z,ee;return[e("div",Ye,[n(p)===1?(m(),oe(A,{key:0,name:"planId",type:"hidden",class:"form-control",value:(F=n(i))==null?void 0:F._id},null,8,["value"])):R("",!0),e("div",Ze,[t[7]||(t[7]=e("label",{class:"form-label text-sharp"},"Plan Name",-1)),g(A,{name:"name",type:"text",placeholder:"Plan Name",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(K=n(i))==null?void 0:K.name},null,8,["value"]),e("span",et,u(d.name),1)]),e("div",tt,[t[8]||(t[8]=e("label",{class:"form-label text-sharp"},"Engine",-1)),g(A,{name:"engine",type:"text",placeholder:"Engine",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(Q=n(i))==null?void 0:Q.engine},null,8,["value"]),e("span",st,u(d.engine),1)]),e("div",nt,[t[9]||(t[9]=e("label",{class:"form-label text-sharp"},"Description",-1)),g(A,{name:"description",as:"textarea",rows:"3",placeholder:"Description",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(W=n(i))==null?void 0:W.description},null,8,["value"]),e("span",ot,u(d.description),1)]),e("div",at,[t[10]||(t[10]=e("label",{class:"form-label text-sharp"},"Duration (days)",-1)),g(A,{name:"duration",type:"number",placeholder:"Duration",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(X=n(i))==null?void 0:X.duration},null,8,["value"]),e("span",lt,u(d.duration),1)]),e("div",rt,[t[11]||(t[11]=e("label",{class:"form-label text-sharp"},"Min Amount",-1)),g(A,{name:"minAmount",type:"number",placeholder:"Min Amount",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(Y=n(i))==null?void 0:Y.minAmount},null,8,["value"]),e("span",it,u(d.minAmount),1)]),e("div",dt,[t[12]||(t[12]=e("label",{class:"form-label text-sharp"},"Max Amount",-1)),g(A,{name:"maxAmount",type:"number",placeholder:"Max Amount",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(Z=n(i))==null?void 0:Z.maxAmount},null,8,["value"]),e("span",ut,u(d.maxAmount),1)]),e("div",ct,[t[13]||(t[13]=e("label",{class:"form-label text-sharp"},"Daily Percentage Profit (%)",-1)),g(A,{name:"dailyPercentageProfit",type:"number",placeholder:"Daily Percentage Profit",class:"form-control","validate-on-input":!0,value:n(p)===0?"":(ee=n(i))==null?void 0:ee.dailyPercentageProfit},null,8,["value"]),e("span",pt,u(d.dailyPercentageProfit),1)]),e("div",mt,[e("div",ft,[t[15]||(t[15]=e("label",{class:"form-label text-sharp"},"Assets",-1)),e("button",{onClick:t[2]||(t[2]=()=>B(!0)),type:"button",class:"py-1 btn btn-outline-success btn-xs"},t[14]||(t[14]=[k(" Add "),e("i",{class:"bi bi-plus"},null,-1)]))]),e("div",vt,[(m(!0),h(q,null,I(n(P),C=>{var te,se;return m(),h("a",{key:C._id,class:ae(`border p-2 rounded-5 shadow overflow-hidden ${((te=n(x))==null?void 0:te._id)===C._id?"border-danger":""} position-relative`),href:"javascript: void(0);",onClick:()=>z(C)},[((se=n(x))==null?void 0:se._id)===C._id?(m(),h("span",{key:0,onClick:()=>f(C),class:"position-absolute bg-danger top-0 bottom-0 start-0 end-0 bg-opacity-15"},null,8,_t)):R("",!0),e("img",{src:`/icons/crypto-svg/${C.logo}`,class:"me-2",alt:C.name,width:"24"},null,8,bt),e("span",gt,u(C.name),1)],10,ht)}),128))])])])]}),_:1},8,["is-open","validation-schema","title"]),g(J,{"is-open":n(G),"close-self":!0,"only-one-btn":!0,onClose:t[4]||(t[4]=()=>B(!1)),onConfirm:t[5]||(t[5]=()=>B(!1)),"z-index":700},{default:V(()=>[e("div",yt,[(m(!0),h(q,null,I(n($),d=>(m(),h("a",{key:d._id,class:ae("border p-2 rounded-5 shadow overflow-hidden position-relative"),href:"javascript: void(0);",onClick:()=>l(d)},[n(P).filter(F=>F._id===d._id).length?(m(),h("span",{key:0,onClick:ge(()=>f(d),["stop"]),class:"position-absolute bg-danger top-0 bottom-0 start-0 end-0 bg-opacity-15"},null,8,wt)):R("",!0),e("img",{src:`/icons/crypto-svg/${d.logo}`,class:"me-2",alt:d.name,width:"24"},null,8,At),e("span",Ct,u(d.name),1)],8,Pt))),128))])]),_:1},8,["is-open"])],64)}}});export{Mt as _};
